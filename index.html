<!DOCTYPE HTML>
<html>
<head>
<meta charset=\"UTF-8\">
<title>Agoran Calls for Judgement</title>
<style>
table{
    font: 1em/1.2 \"Helvetica Neue\", Helvetica, Arial, Geneva, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

a:link     {text-decoration: none;  color: #444;}
a:visited  {text-decoration: none;  color: #777;}

tr:hover {background-color: #ddd;}

td, th {
    border: 1px solid #ddd;
    padding: 4px;
    overflow: hidden;
}
.cs{font-weight:bold;}
.cl{font-size:80%;}
.ht{font-size:70%; font-style:italic;}
.st{font-size:80%;}
.acs{font-weight:bold;}
.acl{font-size:80%;}
.aht{font-size:70%;}
.ast{font-size:80%;}

td a{
  display: block;
  margin: -10cm;
  padding: 10cm;
}

th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #444;
    color: white;
}
</style>
</head>
<body id="main">
</body>

<script>
const path = "https://agoranomic.org/cases/"

// index_build() outputs the cfj index.  It does not build it from scratch,
// but simply loads out_01.html and out_00.html which are generated by a
// PHP script run manually (building from scratch each time is very slow).
// out_01.html contains the most recent few hundred cases and is loaded first
// (for speed of response), then the bulk of the older cases are loaded from
// out_00.html.
function index_build(){
  // table headers
  document.getElementById("main").innerHTML = 
  "<table><tr> <th>Case</th> <th>Caller</th> <th>Statement</th> <th>Last Activity</th>" +
  "<tbody id=\"up\"> </tbody> <tbody id=\"dn\"> </tbody> </table>";  

  // Load top of index table - separated so first section shows quickly
  i_up = new XMLHttpRequest();
  i_up.onload = function() {
    document.getElementById("up").innerHTML = 
      (i_up.status === 200) ? i_up.responseText : `oops: i_up ${i_up.status}: ${i_up.statusText}`;
  };  
  i_up.open('GET', path + "out01.html");
  i_up.send();

  // Load remainder of index table (long)
  let i_dn = new XMLHttpRequest();
  i_dn.onload = function() {
    document.getElementById("dn").innerHTML = 
      (i_dn.status === 200) ? i_dn.responseText : `oops: i_dn ${i_dn.status}: ${i_dn.statusText}`;
  };  
  i_dn.open('GET', path + "out00.html");
  i_dn.send();
}

// building the page for a single cfj
function case_build(case_text){
  document.getElementById("main").innerHTML = 
  "<pre>\n" + case_text + "\n</pre>";
}

// Get query text  
const queryString = window.location.search.slice(1);
    //document.write( queryString);
    // cfj IDs must match beginning of line, 1-4 numbers, 0-1 letters, end of line
    if ((queryString)&&(queryString.match(/^[0-9]{1,4}[a-zA-Z]{0,1}$/))){
      xhr = new XMLHttpRequest();
      xhr.onload = function() {
        if (xhr.status === 200){case_build(xhr.responseText);} 
        else{index_build();}
      }  
      xhr.open('GET', path + queryString);
      xhr.send();
    }
    else{
      index_build();
    }
             
</script>





</html>
